SELECT LOCACAO.DATARETIRADA, MOTORISTA.NOME
FROM MOTORISTA JOIN LOCACAO ON MOTORISTA.NROCNH = LOCACAO.NROCNH
ORDER BY LOCACAO.DATARETIRADA;

SELECT LOCACAO.KMRETIRADA, MOTORISTA.NOME
FROM MOTORISTA JOIN LOCACAO ON MOTORISTA.NROCNH = LOCACAO.NROCNH
ORDER BY KMRETIRADA DESC;

SELECT COUNT(*)
FROM LOCACAO;

SELECT EXTRACT(YEAR FROM DATARETIRADA), COUNT(*)
FROM LOCACAO
GROUP BY EXTRACT(YEAR FROM DATARETIRADA);

SELECT PLACA, COUNT(*) AS "QUANTIDADE" 
FROM locacao 
GROUP BY placa
HAVING COUNT(*) > 1
ORDER BY COUNT(*) DESC;

SELECT LOCACAO.NROCNH, MOTORISTA.NOME, COUNT(*) AS "QUANTIDADE"
FROM MOTORISTA JOIN LOCACAO ON MOTORISTA.NROCNH = LOCACAO.NROCNH
GROUP BY MOTORISTA.NOME;

SELECT VEICULO.PLACA, TIPO.DESCRICAO, COUNT(*) AS "QUANTIDADE"
FROM VEICULO JOIN TIPO ON VEICULO.CODTIPO = TIPO.CODTIPO
GROUP BY TIPO.DESCRICAO
ORDER BY COUNT(*) DESC;

SELECT TIPO.DESCRICAO, COUNT(*) AS "QUANTIDADE", SUM(locacao.VALORLOCACAO) AS "VALOR TOTAL"
FROM VEICULO 
JOIN TIPO ON VEICULO.CODTIPO = TIPO.CODTIPO
JOIN LOCACAO ON LOCACAO.PLACA = VEICULO.PLACA
GROUP BY TIPO.DESCRICAO
ORDER BY COUNT(*) DESC;

SELECT TIPO.DESCRICAO, COUNT(*) AS "QUANTIDADE", SUM(locacao.VALORLOCACAO) AS "VALOR TOTAL"
FROM VEICULO 
JOIN TIPO ON VEICULO.CODTIPO = TIPO.CODTIPO
JOIN LOCACAO ON LOCACAO.PLACA = VEICULO.PLACA
GROUP BY TIPO.DESCRICAO
HAVING SUM(locacao.VALORLOCACAO) > 2000
ORDER BY COUNT(*) DESC;

CREATE VIEW V_TIPO_TOTAL_LOCACAO AS
SELECT TIPO.DESCRICAO, COUNT(*) AS "QUANTIDADE", SUM(locacao.VALORLOCACAO) AS "VALOR TOTAL"
FROM VEICULO 
JOIN TIPO ON VEICULO.CODTIPO = TIPO.CODTIPO
JOIN LOCACAO ON LOCACAO.PLACA = VEICULO.PLACA
GROUP BY TIPO.DESCRICAO
HAVING SUM(locacao.VALORLOCACAO) > 2000
ORDER BY COUNT(*) DESC;

CREATE VIEW VEICULO_TIPO AS
SELECT VEICULO.PLACA, TIPO.DESCRICAO
FROM VEICULO 
JOIN TIPO ON VEICULO.CODTIPO = TIPO.CODTIPO;

SELECT * FROM VEICULO_TIPO
WHERE DESCRICAO = "Passeio";